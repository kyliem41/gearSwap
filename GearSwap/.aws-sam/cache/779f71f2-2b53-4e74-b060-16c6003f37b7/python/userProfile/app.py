import base64
import psycopg2
import os
import json
from psycopg2.extras import RealDictCursor
from datetime import datetime
import jwt
import requests
from jwt.algorithms import RSAAlgorithm
import boto3

MAX_FILE_SIZE = 5 * 1024 * 1024
ALLOWED_CONTENT_TYPES = {
    'image/jpeg',
    'image/png'
}

def cors_response(status_code, body, content_type='application/json'):
    """Helper function to create responses with proper CORS headers"""
    headers = {
        'Content-Type': content_type,
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Headers': 'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token',
        'Access-Control-Allow-Methods': 'OPTIONS,POST,GET,PUT,DELETE'
    }
    
    if content_type == 'application/json':
        body = json.dumps(body, default=str)
    
    return {
        'statusCode': status_code,
        'headers': headers,
        'body': body,
        'isBase64Encoded': content_type != 'application/json'
    }
    
def lambda_handler(event, context):
    if event['httpMethod'] == 'OPTIONS':
        return cors_response(200, {'message': 'OK'})
    
    http_method = event['httpMethod']
    resource_path = event['resource']
    
    try:
        auth_header = event.get('headers', {}).get('Authorization')
        if not auth_header:
            return cors_response(401, {'error': 'No authorization header'})

        # Extract token from Bearer authentication
        token = auth_header.split(' ')[-1]
        verify_token(token)
    except Exception as e:
        return cors_response(401, {'error': f'Authentication failed: {str(e)}'})

    if resource_path == '/userProfile/{Id}':
        if http_method == 'POST':
            return createProfile(event, context)
        elif http_method == 'GET':
            return getUserProfile(event, context)
        elif http_method == 'PUT':
            return putUserProfile(event, context)
        elif http_method == 'DELETE':
            return deleteUserProfile(event, context)
    elif resource_path == '/userProfile/{Id}/profilePicture':
        return updateProfilePicture(event, context)

    return cors_response (400, {'error': 'Unsupported route'})
    
########################
#AUTH
def verify_token(token):
    # Get the JWT token from the Authorization header
    if not token:
        raise Exception('No token provided')

    region = boto3.session.Session().region_name
    
    # Get the JWT kid (key ID)
    headers = jwt.get_unverified_header(token)
    kid = headers['kid']

    # Get the public keys from Cognito
    url = f'https://cognito-idp.{region}.amazonaws.com/{os.environ["COGNITO_USER_POOL_ID"]}/.well-known/jwks.json'
    response = requests.get(url)
    keys = response.json()['keys']

    # Find the correct public key
    public_key = None
    for key in keys:
        if key['kid'] == kid:
            public_key = RSAAlgorithm.from_jwk(json.dumps(key))
            break

    if not public_key:
        raise Exception('Public key not found')

    # Verify the token
    try:
        payload = jwt.decode(
            token,
            public_key,
            algorithms=['RS256'],
            audience=os.environ['COGNITO_CLIENT_ID'],
            options={"verify_exp": True}
        )
        return payload
    except jwt.ExpiredSignatureError:
        raise Exception('Token has expired')
    except jwt.InvalidTokenError:
        raise Exception('Invalid token')

##############
def json_serial(obj):
    """JSON serializer for objects not serializable by default json code"""
    if isinstance(obj, datetime):
        return obj.isoformat()
    raise TypeError(f"Type {type(obj)} not serializable")

def get_db_connection():
    return psycopg2.connect(
        host=os.environ['DB_HOST'],
        user=os.environ['DB_USER'],
        password=os.environ['DB_PASSWORD'],
        port=os.environ['DB_PORT'],
        
        connect_timeout=5
    )

#############
def createProfile(event, context):
    try:
        # Parse the request body
        if isinstance(event.get('body'), str):
            body = json.loads(event['body'])
        else:
            body = json.loads(event.get('body', '{}'))

        user_id = event['pathParameters']['Id']
        bio = body.get('bio')
        location = body.get('location')
        
        default_profile_picture = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQACWAJYAAD/4QAC/9sAQwADAgICAgIDAgICAwMDAwQGBAQEBAQIBgYFBgkICgoJCAkJCgwPDAoLDgsJCQ0RDQ4PEBAREAoMEhMSEBMPEBAQ/8IACwgHgAeAAQERAP/EAB4AAQACAgMBAQEAAAAAAAAAAAAICQYHBAUKAwIB/9oACAEBAAAAALUwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAABzPUlygAAAAAAAAAAAAAAAAAAAAHS+XT8AAAAAAAAAAAAAAAAAA/fqK7sAAAAAAAAAAAAAAAAAAAAB0tPH5AAAAAAAAAAAAAAAAAB+rjuzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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i5JO4ADBOSUMB0IrDdpAFz3ufiUHJ6Gc6Etxv0QQ470GFN1dWFwQd4IPgSrWdRKD18g/DEHz4svH4nZruwhA6iQ/iiKZ8Vbh4Eq11avqAskh81Tq189IfE7NZVr6cNJGbcWTrF89EeBDGwCRRlz87W9cMbkNI5a1+4ED0+J1NiWjcNa/eAR64U3BjljDj/O3gOpz1SK0sx8joov5rfFLG7arJ9LD6DSdfy23eA4a6isqPpZTbjo9Up/D8UlrKayn+liNuOj1q/m8Bm2JGilmJ8gCcE30UeQlF/KuiPT4pBtpIkgLrf7yaS+uF2PG6hlI8wQfAVTZusqm6treSFz5D4rY3brKVurW/mgQ+R8BQdqRL1MP6yS/L4rJ2LKvUzfrHF8/AUG6rII+tkt36Utj3r8Vk2UyaHXR379KKw728BDsVQLk/LF79lpm0R5BbD4rvbsrMukD3FbjA2MpFwfl4B8ZWiZIx6syj1+LRulWJVcejKw8AwbFl64TN6WhsfPv+LSc1USmZfS01h5d3gHcdpYolQZecvxbcdlZYih+Zi8AwclaoqXB9bQL6W+LScmanqUA9bTt6X8A77D1AkYf1SH4tvtPUGRR/VGPAPuijRP/AB+Le6WN0/8ALwDI+zUuv+nxaBf2qlF/18AvIYGztTu3+vxadg0J0b/THmPAE/hOBsBZiT/n8WnYSrAj/LH5R4A/8psevxb64O/6JfAGT2EleNlVmyOQJBORxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWxrlby2NcreWwl9EsiBSRfdcf8AuIH/2Q=="
        profilePicture = body.get('profilePicture', default_profile_picture)

    except json.JSONDecodeError:
        return cors_response(400, "Invalid JSON format in request body")

    try:
        with get_db_connection() as conn:
            with conn.cursor(cursor_factory=RealDictCursor) as cursor:
                # Check if the user exists and get their username
                cursor.execute("SELECT username FROM users WHERE id = %s", (user_id,))
                user = cursor.fetchone()
                if not user:
                    return cors_response(404, "User not found")
                username = user['username']

                # Insert a new profile into the userProfile table
                insert_query = """
                INSERT INTO userProfile (userId, username, bio, location, profilePicture) 
                VALUES (%s, %s, %s, %s, %s)
                RETURNING id, userId, username, bio, location, profilePicture;
                """
                cursor.execute(insert_query, (user_id, username, bio, location, profilePicture))
                new_profile = cursor.fetchone()

                # Update the profileInfo column in the users table with the new profile ID
                update_user_query = """
                UPDATE users
                SET profileInfo = %s
                WHERE id = %s;
                """
                cursor.execute(update_user_query, (new_profile['id'], user_id))

                # Commit both the insertion and the update
                conn.commit()

        return cors_response(201, {
            "message": "UserProfile created successfully and user profileInfo updated",
            "profile": new_profile
        })

    except psycopg2.IntegrityError as e:
        print(f"IntegrityError: {str(e)}")
        return cors_response(400, "UserProfile for this user already exists")
    except Exception as e:
        print(f"Failed to create profile. Error: {str(e)}")
        return cors_response(500, f"Error creating profile: {str(e)}")

################
def getUserProfile(event, context):
    user_id = event['pathParameters']['Id']

    get_query = """
    SELECT *
    FROM userProfile up
    JOIN users u ON up.userId = u.id
    WHERE up.userId = %s
    """
    
    try:
        with get_db_connection() as conn:
            with conn.cursor(cursor_factory=RealDictCursor) as cursor:
                cursor.execute(get_query, (user_id,))
                userProfile = cursor.fetchone()

        if userProfile:
            return cors_response(200, {
                "message": "UserProfile retrieved successfully",
                "userProfile": userProfile
            })
        else:
            return cors_response(404, "UserProfile not found")
            
    except Exception as e:
        print(f"Failed to get profile. Error: {str(e)}")
        return cors_response(500, f"Error getting profile: {str(e)}")

############
def putUserProfile(event, context):
    try:
        if isinstance(event.get('body'), str):
            body = json.loads(event['body'])
        else:
            body = json.loads(event.get('body', '{}'))

        user_id = event['pathParameters']['Id']
        bio = body.get('bio')
        location = body.get('location')
        profilePicture = body.get('profilePicture')

    except json.JSONDecodeError:
        return cors_response(400, "Invalid JSON format in request body")

    update_query = """
    UPDATE userProfile    
    SET bio = COALESCE(%s, bio), 
        location = COALESCE(%s, location), 
        profilePicture = COALESCE(%s, profilePicture)
    WHERE userId = %s 
    RETURNING id, userId, bio, location, profilePicture;
    """
    
    try:
        with get_db_connection() as conn:
            with conn.cursor(cursor_factory=RealDictCursor) as cursor:
                print("Executing update query")
                cursor.execute(update_query, (bio, location, profilePicture, user_id))
                updated_userProfile = cursor.fetchone()
                
                if updated_userProfile:
                    cursor.execute("SELECT username FROM users WHERE id = %s", (user_id,))
                    user = cursor.fetchone()
                    if user:
                        updated_userProfile['username'] = user['username']
                
                conn.commit()
        
        if updated_userProfile:
            return cors_response(200, {
                "message": "UserProfile updated successfully",
                "updated_userProfile": updated_userProfile
            })
        else:
            return cors_response(404, "UserProfile not found")
        
    except Exception as e:
        print(f"Failed to update UserProfile. Error: {str(e)}")
        print(f"Error type: {type(e)}")
        return cors_response(500, f"Error updating UserProfile: {str(e)}")

##########
def deleteUserProfile(event, context):
    try:
        user_id = event['pathParameters']['Id']
        
        delete_query = "DELETE FROM userProfile WHERE userId = %s RETURNING id;"

        with get_db_connection() as conn:
            with conn.cursor(cursor_factory=RealDictCursor) as cursor:
                cursor.execute(delete_query, (user_id,))
                deleted_userProfile = cursor.fetchone()
                conn.commit()
        
        if deleted_userProfile:
            return cors_response(200, {
                "message": "UserProfile deleted successfully",
                "deletedProfileId": deleted_userProfile['id']
            })

        else:
            return cors_response(404, "UserProfile not found")
        
    except Exception as e:
        print(f"Failed to delete UserProfile. Error: {str(e)}")
        return cors_response(500, f"Error deleting UserProfile: {str(e)}")
    
##########
# IMAGES
def updateProfilePicture(event, context):
    try:
        user_id = event['pathParameters']['Id']
        
        # Parse body with more detailed error handling
        try:
            if isinstance(event.get('body'), str):
                try:
                    body = json.loads(event['body'])
                except json.JSONDecodeError as e:
                    print(f"Raw body content (first 100 chars): {event['body'][:100]}")
                    return cors_response(400, {'error': 'Invalid JSON format in request body'})
            else:
                body = event.get('body', {})
            
            print("Parsed body keys:", body.keys() if body else "No body")
        except Exception as e:
            print(f"Body parsing error: {str(e)}")
            return cors_response(400, {'error': 'Could not parse request body'})

        # Validate required fields exist
        if not isinstance(body, dict):
            return cors_response(400, {'error': 'Request body must be a JSON object'})
            
        if 'profilePicture' not in body or 'content_type' not in body:
            return cors_response(400, {'error': 'Missing required fields'})

        profile_picture = body['profilePicture']
        content_type = body['content_type']

        # Validate and clean the base64 string
        if not isinstance(profile_picture, str):
            return cors_response(400, {'error': 'Profile picture must be a base64 string'})
            
        # Remove any potential data URI prefix
        if 'base64,' in profile_picture:
            profile_picture = profile_picture.split('base64,')[1]

        # Clean the string
        profile_picture = profile_picture.strip()
        profile_picture = profile_picture.replace('\n', '')
        profile_picture = profile_picture.replace('\r', '')
        profile_picture = profile_picture.replace(' ', '')

        # Validate content type
        if not content_type.startswith('image/'):
            return cors_response(400, {'error': 'Invalid content type'})

        # Try decoding the base64 string
        try:
            decoded_data = base64.b64decode(profile_picture)
            file_size = len(decoded_data)
            
            if file_size > MAX_FILE_SIZE:
                return cors_response(400, {
                    'error': f'Image size ({file_size} bytes) exceeds limit ({MAX_FILE_SIZE} bytes)'
                })
        except Exception as e:
            print(f"Base64 decode error: {str(e)}")
            return cors_response(400, {'error': 'Invalid base64 image data'})

        # Prepare the full image data string
        full_image_data = f'data:{content_type};base64,{profile_picture}'

        # Update database
        update_query = """
        UPDATE userProfile 
        SET profilePicture = %s
        WHERE userId = %s
        RETURNING id, userId, profilePicture;
        """
        
        with get_db_connection() as conn:
            with conn.cursor(cursor_factory=RealDictCursor) as cursor:
                cursor.execute(update_query, (full_image_data, user_id))
                updated_profile = cursor.fetchone()
                conn.commit()
                
                if updated_profile:
                    return cors_response(200, {
                        'message': 'Profile picture updated successfully',
                        'profile': updated_profile
                    })
                
                return cors_response(404, {'error': 'Profile not found'})
                
    except Exception as e:
        print(f"Unexpected error: {str(e)}")
        return cors_response(500, {'error': str(e)})